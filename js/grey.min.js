var bugTF=!1,speed=150,allGap=150,changeGap=!0,allGap=150,minGap=100;function birdFly(){let birdTop=$bird.offset().top;birdY=0,birdFlySetTime=setInterval(()=>{birdY+=1,birdTop+=birdY,$bird.stop(!0).animate({top:birdTop},30),birdFlyAuto&&10==birdY&&(birdY=-10,birdTop+=birdY)},30)}function birdFlyOnce(){$("main").on("click",()=>{birdY=-10}),$(document).keydown(e=>{32==e.keyCode&&(birdY=-10)})}function createWindow(){for(let i=0;i<2;i++)$window_ol.append("<li date-key="+i+"></li>");$window_ol.append($window_ol.children().clone()),$window_ol.css({width:4*bgImgWidth,height:bodyHeight})}function skyMove(bgImgPositionLength,bgImgPositionTime){$window_ol.animate({left:"-="+(bgImgPositionLength||bgImgWidth)},bgImgPositionTime||skyMoveTime,"linear",()=>{$window_ol.css("left","0px")})}function CreatPiping(num,gap){this.num=String(num),this.gap=gap||allGap,this.radomDown=errorPipingPosition+Math.round(Math.random()*errorPipingPosition),this.radomUp=bodyHeight-this.gap-this.radomDown,this.pipingUp=$("<div class='up'>"),this.pipingDown=$("<div class='down'>"),this.pipingUp.addClass(this.num),this.pipingDown.addClass(this.num),this.pipingUp.css({bottom:-(420-this.radomUp),left:bodyWidth}),this.pipingDown.css({top:-(420-this.radomDown),left:bodyWidth});let $window=$("#window");$window.append(this.pipingDown),$window.append(this.pipingUp)}function PipingMove(num){this.num=String(num);let PipingMoveTime=(bodyWidth+52)/speed*1e3,pipingDown=$window.find("div.down."+this.num),pipingUp=$window.find("div.up."+this.num),checkOver=!1,checks=setInterval(()=>{checkOver||(new Check(pipingDown),new Check(pipingUp))},30,pipingDown,pipingUp);function Check(piping){this.piping=piping;let birdPositionArr=this.positionBird(),pipingPositionArr=this.positionPiping(this.piping),checkTF;birdPositionArr[1]>=pipingPositionArr[1]+pipingPositionArr[2]?checkOver||(fractionalNum++,$(".fractionalNum").text(fractionalNum),checkOver=!0):bugTF||((birdPositionArr[0]<0||birdPositionArr[0]>bodyHeight)&&gameOver(),this.checkPiping(birdPositionArr[0],birdPositionArr[1],birdPositionArr[2],pipingPositionArr[0],pipingPositionArr[1],pipingPositionArr[2],pipingPositionArr[3])&&gameOver())}pipingDown.animate({left:-52},PipingMoveTime,"linear",()=>{pipingDown.remove(),clearInterval(checks)}),pipingUp.animate({left:-52},PipingMoveTime,"linear",()=>{pipingUp.remove(),clearInterval(checks)}),Check.prototype={positionBird:function(){let bird=$("#bird>div"),birdFlyTop,birdFlyLeft;return[parseInt(bird.offset().top),parseInt(bird.offset().left),30]},positionPiping:function(piping){let pipingTop=parseInt(piping.offset().top),pipingLeft=parseInt(piping.offset().left),pipingPositionY,pipingHeight;return pipingTop<0&&(pipingTop=0),pipingPositionY=piping.hasClass("down")?piping.css("top"):piping.css("bottom"),[pipingTop,pipingLeft,52,parseInt(pipingPositionY)+420]},checkPiping:function(birdFlyTop,birdFlyLeft,birdSide,pipingTop,pipingLeft,pipingWidth,pipingHeight){let minX,maxX,minY,maxY;return birdFlyLeft>=pipingLeft-birdSide&&birdFlyLeft<=pipingLeft+pipingWidth&&birdFlyTop>=pipingTop-birdSide&&birdFlyTop<=pipingTop+pipingHeight}}}function gameStart(){let bgImgPositionLength=bgImgWidth+parseFloat($window_ol.css("left")),bgImgPositionTime=bgImgPositionLength/speed*1e3;skyMoveTime=bgImgWidth/speed*1e3,skyMove(bgImgPositionLength,bgImgPositionTime),skyMoveOnce=setTimeout(()=>{skyMove(),skyMoveSetTime=setInterval((function(){skyMove()}),skyMoveTime)},bgImgPositionTime),num=1,testNum=1,nowGap=allGap,createPiping=setInterval(()=>{changeGap?(testNum?testNum--:(nowGap-=5,nowGap<minGap&&(nowGap=minGap),testNum=1),new CreatPiping(num,nowGap)):new CreatPiping(num),new PipingMove(num),num++},skyMoveTime/4)}function gameOver(){clearInterval(birdFlySetTime),$bird.stop(!0),clearInterval(createPiping),$window.children("div").stop(!0),clearTimeout(skyMoveOnce),clearInterval(skyMoveSetTime),$window_ol.stop(!0),$window.children("span").hide(),$bird.stop(!0).css("animation-play-state","paused"),$("#overGame>div").css("background","rgba(0, 0, 0, 0.6)"),$("#overGame>div>.over").show()}$((function(){bodyWidth=$(document).width(),bodyHeight=$(document).height(),bgImgWidth=4/3*bodyHeight,errorPipingPosition=bodyHeight/4,$window=$("#window"),$window_ol=$("#window>ol"),$bird=$("#bird"),birdFlyAuto=!0,birdFly(),createWindow();let speedAfterGame=30;skyMoveTime=bgImgWidth/30*1e3,skyMove(),skyMoveSetTime=setInterval((function(){skyMove()}),skyMoveTime),$(".start").on("click",()=>{$(".start").hide(),$window_ol.siblings(".fractionalNum").show(),fractionalNum=0,birdFlyAuto=!1,birdFlyOnce(),clearInterval(skyMoveSetTime),$window_ol.stop(!0),gameStart()}),$(".againGame").on("click",()=>{window.location.reload()})})),$(window).resize((function(){window.location.reload()}));